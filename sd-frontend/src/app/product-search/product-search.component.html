<div class="app-container">
    <!-- Nagłówek i nawigacja -->
    <div class="header-nav">
        <h2>Wyszukiwanie produktów</h2>
        <button class="nav-button" (click)="goToShoppingList()">Przejdź do listy zakupów</button>
    </div>

    <!-- Formularz wyszukiwania -->
    <div class="search-container">
        <div class="search-box">
            <input
                [(ngModel)]="query"
                (input)="searchProductsAsYouType()"
                placeholder="Wpisz nazwę produktu, aby wyszukać..."
                class="search-input"
            />
        </div>

        <!-- Pole email -->
        <div class="email-input">
            <label for="userEmailSearch">Twój e-mail (potrzebny do dodania produktów):</label>
            <input
                id="userEmailSearch"
                type="email"
                [(ngModel)]="userEmail"
                name="email"
                placeholder="Twój e-mail"
            />
        </div>
    </div>

    <!-- Komunikat o sukcesie -->
    <div *ngIf="successMessage" class="success-message">
        {{ successMessage }}
    </div>

    <!-- Wskaźnik ładowania -->
    <div *ngIf="isLoading" class="loading-indicator">
        <div class="spinner"></div>
        <p>Wyszukiwanie produktów...</p>
    </div>

    <!-- Wyniki wyszukiwania -->
    <div *ngIf="products.length > 0 && !isLoading" class="results-container">
        <h3 *ngIf="query">Znalezione produkty dla: "{{ query }}"</h3>
        <h3 *ngIf="!query">Wszystkie dostępne produkty</h3>




        <ul class="products-list">
            <li *ngFor="let product of products" class="product-card">
                <div *ngIf="product.name && product.name.toLowerCase().includes('mleko')">
                    <img
                            src="assets/images/mleko.png"
                            alt="Mleko"
                            width="100"
                            height="100"
                            class="product-image"
                    />
                </div>
                <div class="product-header">
                    <span class="product-name">{{ product.name }}</span>
                    <span class="product-price">{{ product.price }} zł</span>
                </div>

                <div class="product-details">
                    <div *ngIf="product.brand" class="product-brand">
                        <span>Marka: {{ product.brand }}</span>
                    </div>
                    <div *ngIf="product.weight" class="product-weight">
                        <span>Waga: {{ product.weight }}</span>
                    </div>
                    <div *ngIf="product.city" class="product-city">
                        <span>Miasto: {{ product.city }}</span>
                    </div>
                    <div *ngIf="product.store" class="product-store">
                        <span>Sklep: {{ product.store }}</span>
                    </div>
                </div>

                <div class="product-actions">
                    <button class="add-to-list-btn" (click)="addToShoppingList(product)" [disabled]="addingToList">
                        <span *ngIf="!addingToList">Dodaj do listy zakupów</span>
                        <span *ngIf="addingToList">Dodawanie...</span>
                    </button>
                </div>
            </li>
        </ul>
    </div>


    <!-- Wiadomość, gdy brak wyników -->
    <div *ngIf="products.length === 0 && query" class="no-results">
        <p>Brak wyników dla zapytania: "{{ query }}"</p>
    </div>
</div>
