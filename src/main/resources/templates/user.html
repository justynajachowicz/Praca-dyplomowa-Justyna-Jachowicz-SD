<!doctype html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Użytkownik</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link th:href="@{/webjars/bootstrap/4.6.2/css/bootstrap.min.css}" rel="stylesheet" />
    <script type="text/javascript" src="/webjars/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="/webjars/bootstrap/4.6.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" th:src="@{../js/application.js}"></script>
</head>
<body>
<div class="container">
    <div class="row mt-5">
        <div class="col-6 mx-auto">
            <h1>Profil użytkownika</h1>
            <div class="mt-2">Nazwa użytkownika: <span sec:authentication="principal.username"/></div>
            <div class="mt-2"> Rola: <span sec:authentication="principal.authorities"/></div>
            <a href="/products" title="Przejdź do listy produktów">Nowa lista zakupów</a>
            <div class="mt-5"><a class="link-primary" th:href="@{/logout}">Wyloguj się</a></div>
            <div class="container-fluid">
                <h1 th:if="${#authorization.expression('hasRole(''ROLE_USER'')')}">Listy dotychczasowych zakupów</h1>
                <section class="container">
                    <div class="row">
                        <table class="table table-bordered table-hover">
                            <tr>
                                <th>Nazwa listy</th>
                                <th>Data zakupów</th>
                                <th>Email</th>
                                <th>Sklep</th>
                                <th>Akcja</th>
                            </tr>
                            <tr th:each="list : ${shoppingList}">
                                <td th:text="${list.listName}"></td>
                                <td th:text="${list.createdAt}"></td>
                                <td th:text="${list.user.email}"></td>
                                <td th:text="${list.shop.name} + ' ' + ${list.shop.city}"></td>
                                <td class="editCustom"><a th:href="${'/administration/product/edit/' + list.id}"
                                                          class="btn btn-info"
                                                          id="editButton"
                                                          th:if="${#authorization.expression('hasRole(''ROLE_ADMIN'')')}">Edytuj</a>
                                    <a th:href="${'/user/shopping/delete/' + list.id}" class="btn btn-danger"
                                       id="deleteButton">Usuń</a>
                                    <a th:href="${'/user/shopping/details/' + list.id}" class="btn btn-warning"
                                       id="addProductButton">
                                        Szczegóły
                                    </a></td>
                            </tr>
                        </table>
                    </div>
                </section>

                <div class="modal" tabindex="-1" role="dialog" id="deleteModal">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Potwierdź usunięcie</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>Jesteś pewien, że chcesz usunąć ten rekord?</p>
                            </div>
                            <div class="modal-footer">
                                <a class="btn btn-primary" id="delRef">Tak, usuń</a>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Zamknij</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>
</body>
</html>